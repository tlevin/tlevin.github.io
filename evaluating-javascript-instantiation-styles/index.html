
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <title>Evaluating Performance of Instantiation Patterns</title>

        <meta name="twitter:card" content="summary">
        <meta name="twitter:title" content="Evaluating Performance of Instantiation Patterns">
        <meta name="twitter:description" content="What does instantiation mean? In object orientated programming when you create an object from a constructor function that passes along shared properties and methods it is called instantiation.  The object that is created is referred to as an instance of its constructor.  Other programming languages refer to the constructor function">
        <meta name="twitter:creator" content="@toddglevin">
        <meta name="twitter:image" content="">
        <meta name="twitter:url" content="http://localhost:2368/evaluating-javascript-instantiation-styles/">
        <meta name="twitter:domain" content="http://localhost:2368">

        <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/css/bootstrap.min.css">
        <link href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
        <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/monokai_sublime.min.css">

        <link href="../assets/css/main.css?v=b5b45cca29" rel="stylesheet">
        <link rel="shortcut icon" href="../favicon.ico">

        <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/js/bootstrap.min.js"></script>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
        <script src="../assets/js/main.js?v=b5b45cca29"></script>
        <script>hljs.initHighlightingOnLoad();</script>

        <link rel="canonical" href="index.html">
    <meta name="referrer" content="origin">
    
    <meta property="og:site_name" content="Todd Levin">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Evaluating Performance of Instantiation Patterns">
    <meta property="og:description" content="What does instantiation mean? In object orientated programming when you create an object from a constructor function that passes along shared properties and methods it is called instantiation.  The object that is created is referred to as an instance of...">
    <meta property="og:url" content="http://localhost:2368/evaluating-javascript-instantiation-styles/">
    <meta property="og:image" content="http://localhost:2368/content/images/2015/10/IMG_0151.jpg">
    <meta property="article:published_time" content="2015-10-10T01:22:50.494Z">
    <meta property="article:modified_time" content="2015-10-12T00:18:02.725Z">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Evaluating Performance of Instantiation Patterns">
    <meta name="twitter:description" content="What does instantiation mean? In object orientated programming when you create an object from a constructor function that passes along shared properties and methods it is called instantiation.  The object that is created is referred to as an instance of...">
    <meta name="twitter:url" content="http://localhost:2368/evaluating-javascript-instantiation-styles/">
    <meta name="twitter:image:src" content="http://localhost:2368/content/images/2015/10/IMG_0151.jpg">
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Todd Levin",
    "author": {
        "@type": "Person",
        "name": "Todd Levin",
        "url": "http://localhost:2368/author/todd",
        "sameAs": null,
        "description": null
    },
    "headline": "Evaluating Performance of Instantiation Patterns",
    "url": "http://localhost:2368/evaluating-javascript-instantiation-styles/",
    "datePublished": "2015-10-10T01:22:50.494Z",
    "dateModified": "2015-10-12T00:18:02.725Z",
    "image": "http://localhost:2368/content/images/2015/10/IMG_0151.jpg",
    "description": "What does instantiation mean? In object orientated programming when you create an object from a constructor function that passes along shared properties and methods it is called instantiation.  The object that is created is referred to as an instance of..."
}
    </script>

    <meta name="generator" content="Ghost 0.7">
    <link rel="alternate" type="application/rss+xml" title="Todd Levin" href="../rss/index.html">
        <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-68513712-1', 'auto');
  ga('send', 'pageview');

    </script>
    </head>
    <body>
        <div id="wrap">
            <div class="navbar navbar-inverse navbar-static-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../">Todd Levin</a>
        </div>
        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
                    <li><a href="../">home</a></li>

                <li><a href="http://github.com/tlevin" target="_blank"><i class="fa fa-github fa-lg"></i></a></li>
                <li><a href="http://twitter.com/toddglevin" target="_blank"><i class="fa fa-twitter fa-lg"></i></a></li>
                <li><a href="https://www.linkedin.com/in/toddglevin" target="_blank"><i class="fa fa-linkedin"></i></a></li>
            </ul>
        </div>
    </div>
</div>

            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-lg-offset-2 centered">
                        <main>
    <article class="post">
            <header>
                <h1>Evaluating Performance of Instantiation Patterns</h1>
                <h5>
                    <time datetime="2015-10-09">10/09/2015</time>
                </h5>
            </header>

            <section class="posts">
                <h3 id="whatdoesinstantiationmean">What does instantiation mean?</h3>

<p>In object orientated programming when you create an object from a constructor function that passes along shared properties and methods it is called instantiation.  The object that is created is referred to as an instance of its constructor.  Other programming languages refer to the constructor function as a class.</p>

<p>Javascript doesn't force the programming into a set process to create a class and instead supports four different instantiation patterns to achieve this result.</p>

<h3 id="thefourpatternstoinstantiateanobject">The four patterns to instantiate an object</h3>

<ul>
<li><strong>functional</strong></li>
<li><strong>functional with shared methods</strong></li>
<li><strong>prototypal</strong></li>
<li><strong>pseudoclassical</strong></li>
</ul>

<hr>

<h4 id="whatarewecheckingwhenweevaluateeachpattern">What are we checking when we evaluate each pattern?</h4>

<p>There are two aspects to evaluate a program (and in this case the act of instantiation).  I used Chrome devtools to collect a CPU profile which records the time in miliseconds that a specific function takes.  A heap snapsot looks at the memory allocation of each object created on the page measured in megabytes.  For more information about performance testing using Chrome, check out <a href="https://developers.google.com/web/tools/profile-performance/rendering-tools/js-execution">Speed Up JavaScript Execution</a>.</p>

<p>Performance of an application is measured in both time or space and often you have to choose which to optimize for.  Learning how the devtools profiler records performance was valuable to understanding how design choices affects the runtime.  </p>

<hr>

<h4 id="thetestingenvironment">The testing environment</h4>

<p>Let me present the wonderful interface that I built to test an implementation of stack and queue constructors.</p>

<p><img src="../content/images/2015/10/Screen-Shot-2015-10-09-at-9-52-30-PM.png" alt=""></p>

<p>Great, I know.  The JavaScript that was running to create the tests does all of the work behind the scenes.</p>

<pre><code>var queues = [];
var stacks = [];
$(".createStack").click(function() {
    stacks = [];
    while(stacks.length &lt; 100000){
        stacks.push(Stack());
        stacks[stacks.length - 1].push(Math.random());
    }
});
$(".createQueue").click(function() {
    queues = [];
    while(queues.length &lt; 100000){
        queues.push(Queue());
        queues[queues.length - 1].enqueue(Math.random());
    }
});
</code></pre>

<p>It made an array of objects that were instantiated by the pattern being tested. It then called a push method to add to each stack and an enqueue method to add to each queue a random generated number. </p>

<p>Adding an operation on top of instantiation would not affect the result, because adding values to it is a constant time and space operation in this implementation.  The additional jQuery operations were all identical for each test so they can be considered a constant as well.</p>

<hr>

<h2 id="theresults">The Results</h2>

<h5 id="cputime">CPU time</h5>

<p><img src="../content/images/2015/10/Screen-Shot-2015-10-09-at-6-14-45-PM-1.png" alt=""></p>

<p>Ok, first thing you'll notice is functional shared is off the charts.  I determined that based on the cpu profiles that each test had generated the problem was due to the extend function that I used for this pattern.  There was some flaw in how the _.extend from the underscore library was reporting in the CPU profiles I collected.</p>

<p>Of the tests that were ran, pseudoclassical instantiation had a faster run time than the others.  Note that the test script tested it based on 100,000 instances of stack and queue and the execution times were under 1200 ms for all patterns of instantiation.</p>

<hr>

<h5 id="memoryusage">Memory usage</h5>

<p><img src="../content/images/2015/10/Screen-Shot-2015-10-09-at-6-09-41-PM-1.png" alt=""></p>

<p>I noticed that due to the similar data storage type used to implement both stack and queue that there was no noticeable difference in the actual memory usage.  This was expected since they are similar data structures, just with different rules and methods governing access.</p>

<p>The reason functional instantiation was close to double the memory usage is because all methods on the constructor have to be declared in every instance it generates.  This is unlike prototypal and pseudoclassical which use prototype inheritance to pass along the methods, or functional shared which references a shared object of methods.</p>

<hr>

<h4 id="resultstake2">Results (take 2!)</h4>

<p>Not satisfied with flawed data I found out about alternative testing tools to simplify the performance tests.  Not that I didn't enjoy the process of generating my own HTML tester and profile scripts, but it isn't efficient.  Efficiency is the whole idea for this post!</p>

<p>I tried out the site <a href="http://jsperf.com">jsperf.com</a> and found that testing was easy to setup, and the interface was simple.  Here is my <a href="http://jsperf.com/instantiationjs">test setup</a> and the results were in line with my own testing.  I fixed the extend for functional shared and it now performs in line with expectations.</p>

<p><img src="../content/images/2015/10/Screen-Shot-2015-10-11-at-3-07-36-PM-1.png" alt=""></p>

<p>My takeaway from running this second test was the act of testing itself.  I learned valuable lessons about the concept of using various tools to get a good snapshot of how your implementation performs.</p>

<p>Functional instantiation performed poorly here and I thought this was an outlier similar to the error with functional shared in my initial testing.  I checked with other sources that did similar testing and found it to be close to what they surmised.  <a href="http://www.shanemkeller.com/instantiation_patterns_and_execution_speed-2/">Source</a></p>

<h3 id="insummary">In summary</h3>

<p>Depending on the scale of the application, and the complexity of the constructor, instantiation patterns will not make a noticeable difference in its performance.  Despite the difference of 40-50%, the slowest pattern instantiates at hundreds of thousands of objects a second in my tests. If optimizing for time, pseudoclassical has an edge and if optimizing for space, I would avoid functional instantiation.</p>

<p>It has an impact on your program, but it will most likely not affect the user's experience.  This makes it far more a personal choice.  On a personal note, I like the pseudoclassical pattern better, and I am even working on remembering to use the keyword <code>new</code> in my code!</p>

<p>Thanks to <a href="https://github.com/bjarkestaun">Bjarke Staun-Olsen</a> for his help on the implementation and testing as well as to the good people at <a href="http://www.hackreactor.com">Hack Reactor</a> for providing the learning environment.</p>

                <hr>
                <div class="social-buttons">
                    <a href="https://twitter.com/share?text=Evaluating%20Performance%20of%20Instantiation%20Patterns" class="popup fa fa-twitter btn btn-info"></a>
                    <a href="https://www.facebook.com/sharer/sharer.php?u=http://toddlevin.net/evaluating-javascript-instantiation-styles/" class="popup fa fa-facebook btn btn-primary"></a>
                    <a href="https://plus.google.com/share?url=http://toddlevin.net/evaluating-javascript-instantiation-styles/" class="popup fa fa-google btn btn-danger"></a>
                </div>
            </section>

        <!-- Disqus -->
        <div id="disqus_thread"></div>

        <script type="text/javascript">
        var disqus_shortname = 'toddglevin';
        var disqus_identifier = '8';
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </article>
</main>

                    </div>
                </div>
            </div>
        </div>

        <div id="footer">
            <footer>
    <div class="inner">
         <section class="copyright">All content copyright <a href="../">Todd Levin</a> © 2015 • All rights reserved.</section>
    </div>
</footer>
        </div>

        

        <!--  Analytics-->
        

        <!-- Disqus -->
        <script type="text/javascript">
        var disqus_shortname = 'toddglevin';
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
        </script>
    </body>
